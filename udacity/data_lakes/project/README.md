# Sparkify Data Lake


Sparkify is an imaginary music streaming startup seeking to develop a database model that makes querying data from users song plays easy. This document shows how a Data Lake can be built on top of Sparkify data and which files to run for immediate use.


- [Requirements](#requirements)
- [Quick use](#quick-use)
- [The database](#the-database)
- [ETL pipeline](#etl-pipeline)

## Requirements

- Python 3.x.
- configparser
- AWS account
- AWS EMR Cluster

## Quick use

- Launch a [EMR Cluster](https://searchaws.techtarget.com/definition/Amazon-Elastic-MapReduce-Amazon-EMR) and set parameters in ```dl.cfg``` with your SSH keys;

- Run in terminal:

```python etl.py```


## The database

Two datasets feed records to the database: the first dataset is a subset from the well known [Million Song Dataset](http://millionsongdataset.com/), that gathers a bunch of json files about songs. In the second there are log files, also in JSON format, generated by [an event simulator](https://github.com/Interana/eventsim) based on the songs in the first dataset. Data is in S3 buckets.

## ETL pipeline

Here it's used the [schema on read](https://www.techopedia.com/definition/30153/schema-on-read) strategy, which means there is no need to draw a schema before ingesting data into the database.

The ETL pipeline consists in copying data from S3 buckets, processing it with Spark, and then storing it againd on S3.

Data is stored in five tables: songplays, songs, users, artists, time. Each of the five tables are written to parquet files in a separate analytics directory on S3.

To execute the ETL pipeline, you need first to launch a EMR Cluster and set parameters in ```dl.cfg```, which are the SSH keys you got in your downloaded ```.pem``` file. After that, type the command below in terminal:

```
python etl.py
```

You will see the entire process being executed, and if something goes wrong an elucidative message will be displayed on screen.


#### Warning

This project is part of Udacity's Nanodegree in Data Engineering. Some parts of the text do take significant inspiration on the project overview and its instructions.